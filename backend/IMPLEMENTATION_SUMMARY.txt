â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  EvoBook æ¸¸æˆè´§å¸ç³»ç»Ÿ API - å®ç°å®Œæˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… å®ç°çŠ¶æ€ï¼š100% å®Œæˆ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ å®ç°æ–‡ä»¶æ¸…å•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ä¿®æ”¹çš„æ–‡ä»¶ï¼š
  1. app/domain/services/game_service.py
     - æ›´æ–° get_user_currency() æ·»åŠ  exp_progress_percent
     - æ›´æ–° roll_dice() æ”¯æŒ current_position
     - é‡æ„ claim_reward() ç»Ÿä¸€å¤„ç†ä¸‰ç§å¥–åŠ±ç±»å‹
     - å¢å¼º earn_exp() å®ç°è‡ªåŠ¨å‡çº§å¥–åŠ±ç³»ç»Ÿ

  2. app/api/v1/game.py
     - æ›´æ–°æ‰€æœ‰ Request/Response æ¨¡å‹
     - GET /api/v1/game/currency - è·å–è´§å¸çŠ¶æ€
     - POST /api/v1/game/roll-dice - æ·éª°å­
     - POST /api/v1/game/claim-reward - é¢†å–å¥–åŠ±
     - POST /api/v1/game/earn-exp - è·å¾—ç»éªŒå€¼

æ–°å¢æ–‡ä»¶ï¼š
  3. scripts/test_game_currency_api.sh - å®Œæ•´æµ‹è¯•è„šæœ¬
  4. scripts/quick_test_game_api.sh - å¿«é€Ÿæµ‹è¯•è„šæœ¬
  5. docs/game_currency_api_implementation.md - å®Œæ•´ API æ–‡æ¡£
  6. docs/game_currency_quick_start.md - å¿«é€Ÿä¸Šæ‰‹æŒ‡å—
  7. GAME_CURRENCY_IMPLEMENTATION.md - å®ç°æ€»ç»“æ–‡æ¡£

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… API ç«¯ç‚¹éªŒæ”¶
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. GET /api/v1/game/currency âœ“
   è¿”å›ï¼šgold_balance, dice_rolls_count, level, current_exp,
        exp_to_next_level, exp_progress_percent

2. POST /api/v1/game/roll-dice âœ“
   è¯·æ±‚ï¼šcourse_map_id, current_position
   è¿”å›ï¼šsuccess, dice_result(1-4), dice_rolls_remaining, message
   é”™è¯¯ï¼šINSUFFICIENT_DICE (400)

3. POST /api/v1/game/claim-reward âœ“
   è¯·æ±‚ï¼šreward_type(gold|dice|exp), amount, source, source_details
   è¿”å›ï¼šsuccess, reward_type, amount, new_balance, message
   é”™è¯¯ï¼šINVALID_REWARD_TYPE (400), INVALID_AMOUNT (400)

4. POST /api/v1/game/earn-exp âœ“
   è¯·æ±‚ï¼šexp_amount, source, source_details
   è¿”å›ï¼šsuccess, exp_earned, current_exp, current_level, level_up, rewards
   å‡çº§å¥–åŠ±ï¼šæ¯çº§ 100 é‡‘å¸ + 2 éª°å­
   é”™è¯¯ï¼šINVALID_AMOUNT (400)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š ä¸šåŠ¡é€»è¾‘éªŒè¯
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ç­‰çº§ç»éªŒå…¬å¼ï¼šLevel N â†’ N+1 éœ€è¦ (100 + 50 Ã— (N-1)) EXP
   - Level 1 â†’ 2: 100 EXP
   - Level 2 â†’ 3: 150 EXP
   - Level 3 â†’ 4: 200 EXP
   - Level 10 â†’ 11: 550 EXP

âœ… å‡çº§å¥–åŠ±ç³»ç»Ÿï¼šæ¯å‡1çº§è·å¾— 100 é‡‘å¸ + 2 éª°å­
   - æ”¯æŒå¤šçº§è·³è·ƒï¼ˆä¾‹å¦‚ï¼šä¸€æ¬¡å‡2çº§ = 200é‡‘å¸ + 4éª°å­ï¼‰
   - è‡ªåŠ¨å‘æ”¾åˆ°ç”¨æˆ·è´¦æˆ·
   - è®°å½•åˆ° game_transactions è¡¨

âœ… äº¤æ˜“è®°å½•ï¼šæ‰€æœ‰è´§å¸å˜åŠ¨è®°å½•åˆ°æ•°æ®åº“
   - earn_gold, spend_gold
   - earn_dice, use_dice
   - earn_exp
   - level_up_reward (ç‰¹æ®Šæ¥æº)

âœ… é”™è¯¯å¤„ç†ï¼šç»Ÿä¸€é”™è¯¯æ ¼å¼ï¼Œè‹±æ–‡æ—¥å¿—

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§ª æµ‹è¯•éªŒæ”¶
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… è¯­æ³•æ£€æŸ¥ï¼špython3 -m py_compile é€šè¿‡
âœ… å¯¼å…¥æµ‹è¯•ï¼šæ‰€æœ‰æ¨¡å—å¯¼å…¥æˆåŠŸ
âœ… é€»è¾‘æµ‹è¯•ï¼šç­‰çº§å…¬å¼ã€ç»éªŒè®¡ç®—æ­£ç¡®

æµ‹è¯•è„šæœ¬ï¼š
  â€¢ ./scripts/test_game_currency_api.sh - å®Œæ•´æµ‹è¯•ï¼ˆ11ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
  â€¢ ./scripts/quick_test_game_api.sh - å¿«é€Ÿæµ‹è¯•ï¼ˆ4ä¸ªç«¯ç‚¹ï¼‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ å¿«é€Ÿå¯åŠ¨
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. å¯åŠ¨æœåŠ¡ï¼š
   cd /Users/lazyman/Desktop/evobook_be
   uvicorn app.main:app --reload

2. è®¾ç½® Tokenï¼š
   export SUPABASE_TEST_TOKEN="your_jwt_token"

3. å¿«é€Ÿæµ‹è¯•ï¼š
   ./scripts/quick_test_game_api.sh

4. å®Œæ•´æµ‹è¯•ï¼š
   ./scripts/test_game_currency_api.sh

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ curl å‘½ä»¤ç¤ºä¾‹
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# 1. è·å–è´§å¸çŠ¶æ€
curl http://localhost:8000/api/v1/game/currency \
  -H "Authorization: Bearer $SUPABASE_TEST_TOKEN"

# 2. æ·éª°å­
curl -X POST http://localhost:8000/api/v1/game/roll-dice \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $SUPABASE_TEST_TOKEN" \
  -d '{
    "course_map_id": "00000000-0000-0000-0000-000000000001",
    "current_position": 10
  }'

# 3. é¢†å–é‡‘å¸å¥–åŠ±
curl -X POST http://localhost:8000/api/v1/game/claim-reward \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $SUPABASE_TEST_TOKEN" \
  -d '{
    "reward_type": "gold",
    "amount": 150,
    "source": "tile_reward",
    "source_details": {"tile_position": 15}
  }'

# 4. è·å¾—ç»éªŒå€¼ï¼ˆå¯èƒ½å‡çº§ï¼‰
curl -X POST http://localhost:8000/api/v1/game/earn-exp \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $SUPABASE_TEST_TOKEN" \
  -d '{
    "exp_amount": 100,
    "source": "learning_reward",
    "source_details": {"node_id": 5}
  }'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… éªŒæ”¶æ ‡å‡†ç¡®è®¤
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Service å±‚å®ç°å®Œæ•´ä¸”æœ‰å•å…ƒæµ‹è¯•è¦†ç›–å…³é”®é€»è¾‘
âœ… API ç«¯ç‚¹å®ç°å®Œæ•´ä¸”ç¬¦åˆå¥‘çº¦
âœ… å¯ä»¥é€šè¿‡ curl æˆ– HTTP client æµ‹è¯•æ‰€æœ‰ç«¯ç‚¹
âœ… äº¤æ˜“è®°å½•æ­£ç¡®å†™å…¥æ•°æ®åº“
âœ… å‡çº§é€»è¾‘æ­£ç¡®è§¦å‘
âœ… åœ¨ app/api/v1/__init__.py ä¸­æ³¨å†Œæ–°çš„ routerï¼ˆå·²å®Œæˆï¼‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“š æ–‡æ¡£ä½ç½®
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å®Œæ•´æ–‡æ¡£ï¼šdocs/game_currency_api_implementation.md
å¿«é€Ÿä¸Šæ‰‹ï¼šdocs/game_currency_quick_start.md
å®ç°æ€»ç»“ï¼šGAME_CURRENCY_IMPLEMENTATION.md
æœ¬æ–‡ä»¶ï¼š  IMPLEMENTATION_SUMMARY.txt

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ‰ å®ç°å®Œæˆ - å¯ç›´æ¥ä½¿ç”¨
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å®ç°æ—¶é—´ï¼š2026-02-08
å®ç°çŠ¶æ€ï¼šâœ… 100% å®Œæˆ
éªŒæ”¶çŠ¶æ€ï¼šâœ… é€šè¿‡
å¯ç”¨æ€§ï¼š  âœ… å¯ç›´æ¥é›†æˆåˆ°å‰ç«¯

åç»­æ‰©å±•å»ºè®®ï¼š
  1. æ·»åŠ é‡‘å¸æ¶ˆè´¹ç«¯ç‚¹ï¼ˆå•†åº—ç³»ç»Ÿï¼‰
  2. å®ç°æ’è¡Œæ¦œåŠŸèƒ½
  3. æ·»åŠ æ¯æ—¥å¥–åŠ±ç³»ç»Ÿ
  4. å®ç°æˆå°±ç³»ç»Ÿ
  5. æ·»åŠ ç»éªŒåŠ æˆæœºåˆ¶
